<html lang="en">

<!-- Mirrored from htmx.org/essays/splitting-your-apis/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Aug 2023 17:45:24 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
  <title>&lt;/&gt; htmx ~ Splitting Your Data &amp; Application APIs: Going Further</title>
    <link rel="canonical" href="index.html">
    
    <link rel="alternate" type="application/atom+xml" title="Sitewide Atom feed" href="../../atom.xml">
    <link rel="stylesheet" href="../../css/site.css">
    <script src="../../js/htmx.js"></script>
    <script src="../../js/class-tools.js"></script>
    <script src="../../js/preload.js"></script>
    <script src="../../js/_hyperscript.js"></script>
    <meta name="generator" content="Zola v.TODO">
</head>
<body hx-ext="class-tools, preload">

<div class="top-nav">
    <div class="c">
        <div class="menu">
            <div class="logo-wrapper">
                <a href="../../index.html" class="logo light">&lt;<b>/</b>&gt; htm<b>x</b></a>
                <svg _="on click toggle .show on #nav" class="hamburger" viewBox="0 0 100 80" width="25" height="25" style="margin-bottom:-5px">
                    <rect width="100" height="20" style="fill:rgb(52, 101, 164)" rx="10"></rect>
                    <rect y="30" width="100" height="20" style="fill:rgb(52, 101, 164)" rx="10"></rect>
                    <rect y="60" width="100" height="20" style="fill:rgb(52, 101, 164)" rx="10"></rect>
                </svg>
            </div>
            
            <div id="nav" class="navigation" hx-boost="true">
            
                <div class="navigation-items" preload="mouseover">
                    <div><a href="../../docs/index.html">docs</a></div>
                    <div><a href="../../reference/index.html">reference</a></div>
                    <div><a href="../../examples/index.html">examples</a></div>
                    <div><a href="../../talk/index.html">talk</a></div>
                    <div><a href="../index.html">essays</a></div>
                    <div hx-disable>
                        <form action="https://google.com/search">
                            <input type="hidden" name="q" value="site:htmx.org">
                            <label>
                                <span style="display:none;">Search</span>
                                <input type="text" name="q" placeholder="üîçÔ∏è" class="search-box">
                            </label>
                        </form>
                    </div>
                </div>
                <div class="github-stars">
                    <iframe style="margin:auto;" src="https://ghbtns.com/github-btn.html?user=bigskysoftware&amp;repo=htmx&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="150" height="20" title="Star htmx on GitHub"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>


    


<div class="c content ">
    

  <h1>Splitting Your Data &amp; Application APIs: Going Further</h1>
  
    <address>Carson Gross</address>
    <time>September 16, 2021</time>
  

  <p><strong>TLDR:</strong> If you split your API into Data and Application APIs, <a rel="noopener" target="_blank" href="https://max.engineer/server-informed-ui">as advocated here</a>, 
you should consider changing your Application API from JSON to Hypermedia (HTML) &amp; using a <em>hypermedia-oriented</em> library like
<a href="../../index.html">htmx</a> to reap the benefits of the hypermedia model (simplicity, reliability, flexibility, etc.)</p>
<h2 id="the-problem"><a class="zola-anchor" href="#the-problem" aria-label="Anchor link for: the-problem">üîó</a>The Problem</h2>
<p>Recently, <a rel="noopener" target="_blank" href="https://max.engineer/">Max Chernyak</a> wrote an essay entitled 
<a rel="noopener" target="_blank" href="https://max.engineer/server-informed-ui">Don‚Äôt Build A General Purpose API To Power Your Own Front End</a>.  His
TLDR is this:</p>
<blockquote>
<p>YAGNI, unless you‚Äôre working in a big company with federated front-ends or GraphQL.</p>
</blockquote>
<p>He then discusses some of the different needs of a general purpose API and your application API.  He lists the 
following as needs for a generic API:</p>
<div style="padding-left:64px">
<ol>
<li>How to predict and enable all possible workflows</li>
<li>How to avoid N+1 requests for awkward workflows</li>
<li>How to test functionality, performance, and security of every possible request</li>
<li>How to change the API without breaking the existing workflows</li>
<li>How to prioritize API changes between internal and community requirements</li>
<li>How to document everything so that all parties can get stuff done</li>
</ol>
</div>
<p>And these as application API needs:</p>
<div style="padding-left:64px">
<ol>
<li>How to collect all the data needed to render a page</li>
<li>How to optimize requests to multiple endpoints</li>
<li>How to avoid using API data fields in unintended ways</li>
<li>How to weigh the benefit of new features against the cost of new API requests</li>
</ol>
</div>
<p>I will term this misalignment of needs the <strong>Data/App API Impedance Mismatch</strong> problem.</p>
<p>Max‚Äôs recommendation is to split the API into two ‚Äúhalves‚Äù: a generic API and an application API:</p>
<blockquote>
<p>I suggest you stop treating your frontend as some generic API client, and start treating it as a half of your app.</p>
<p>Imagine if you could just send it the whole ‚Äúpage‚Äù worth of JSON. Make an endpoint for <code>/page/a</code> and render the whole JSON for <code>/page/a</code> there. 
Do this for every page. Don‚Äôt force your front-end developers to send a bunch of individual requests to render a complex page. 
Stop annoying them with contrived limitations. Align yourselves.</p>
</blockquote>
<h2 id="right-about-what-s-wrong"><a class="zola-anchor" href="#right-about-what-s-wrong" aria-label="Anchor link for: right-about-what-s-wrong">üîó</a>Right about What‚Äôs Wrong</h2>
<p>I agree entirely with Max on the problem here.</p>
<p>I would particularly emphasise the fact that the generic API needs to be stable, whereas the application API must change 
rapidly to address application needs.</p>
<p>Jean-Jacques Dubray, in <a rel="noopener" target="_blank" href="https://www.infoq.com/articles/no-more-mvc-frameworks/">this article</a> relates the following sad state of affairs for
API designers:</p>
<blockquote>
<p>The worst part of my job these days is designing APIs for front-end developers. The conversation goes inevitably as: </p>
<p>Dev ‚Äì So, this screen has data element x,y,z‚Ä¶ could you please create an API with the response format {x: , y:, z: }</p>
<p>Me ‚Äì Ok</p>
</blockquote>
<p>This is a perfect encapsulation of the tension that Max has noticed, where API engineers want to design general, 
stable APIs, but are subject to the whims of a quickly-changing UI with complex data needs that are often best
solved on <em>the server side</em>.</p>
<p>As Max points out:</p>
<blockquote>
<p>You can keep ‚Äúpage a‚Äù dumb to only do what it needs to do. You test the crap out of ‚Äúpage a‚Äù for bugs, security, performance. You can even fetch everything for ‚Äúpage a‚Äù in a single big SQL query.</p>
</blockquote>
<h2 id="wrong-about-what-s-right"><a class="zola-anchor" href="#wrong-about-what-s-right" aria-label="Anchor link for: wrong-about-what-s-right">üîó</a>Wrong about What‚Äôs Right</h2>
<p>So, again, I agree entirely with Max that there is a Data/App API Impedance Mismatch problem and I applaud him for suggesting 
that, rather than bailing out to a solution to like GraphQL, you split the APIs into two.</p>
<p>However, there is a <strong>next step</strong> to take:</p>
<p>Once you have split your application API from your generic data API, <em>you are no longer bound by the constraints of
a public data API</em> and are free to reconsider the <em>entire form</em> of that application API.  We can do whatever we‚Äôd like with 
it, so let‚Äôs get a bit expansive in our thinking.</p>
<p>Note that core problems with the application API are rapid change and page (or resource) specific tuning.  It turns out that we
have a very good technology for dealing with <em>exactly</em> this problem: <a rel="noopener" target="_blank" href="https://en.wikipedia.org/wiki/Hypermedia">Hypermedia</a>!</p>
<p>Hypermedia, by way of HATEOAS, makes API churn <a rel="noopener" target="_blank" href="https://intercoolerjs.org/2016/02/17/api-churn-vs-security.html">much less of a problem</a>.  When you change the shape of your hypermedia API, well, 
that‚Äôs fine: the <em>new</em> API is simply reflected in the <em>new</em> HTML returned by the server.  You can add and modify end points
and, lo and behold (to a first order of approximation) your clients (that is, browsers) don‚Äôt need to be updated.</p>
<p>The browsers simply see the new HTML, and <a rel="noopener" target="_blank" href="https://intercoolerjs.org/2016/05/08/hatoeas-is-for-humans.html">the humans driving them react to the new functionality appropriately</a>.</p>
<p>So, while I feel Max is on the right track, I also think he <em>doesn‚Äôt go far enough</em>: once you have made the mental 
jump to solving the Data/APP API Impedance Mismatch problem by splitting the two into separate concerns, it is only a 
bit further down the road to rediscovering the advantages of hypermedia.</p>
<p>You may object that: ‚ÄúOh, but hypermedia applications aren‚Äôt very usable, we don‚Äôt want to go back to web 1.0.‚Äù</p>
<p>That is a perfectly reasonable objection, but people have been working on that problem and there are now many libraries 
available that address the usability issues of HTML <em>within the hypermedia model</em>.</p>
<p>Two of my favorites are <a rel="noopener" target="_blank" href="https://unpoly.com/">unpoly</a> and, of course, my own <a href="../../index.html">htmx</a>.</p>
<h2 id="in-conclusion"><a class="zola-anchor" href="#in-conclusion" aria-label="Anchor link for: in-conclusion">üîó</a>In Conclusion</h2>
<p>If you switch to a hypermedia application API (which really just means ‚Äúuse HTML, like you used to‚Äù) then you get all
of the benefits of the REST-ful web model (simplicity, reliability, etc.) and of server-side rendering in mature web frameworks
(caching, SQL tuning, etc.)</p>
<p>And, by choosing a hypermedia-oriented front end technology like htmx, you can create <a href="../../examples/index.html">excellent user experiences</a> within 
that model.</p>
<p>Everything old is new again, but, this time, a little bit better.</p>

  <div style="padding-top: 120px;padding-bottom:40px;text-align: center">
    &lt;/&gt;
  </div>
</div>

<footer>
    <div class="c content ">
        <div class="row">
            <div class="6 col footer-haiku">
                <h2>haiku</h2>
                <p><em>
                    javascript fatigue:<br>
                    longing for a hypertext<br>
                    already in hand
                </em></p>
            </div>
            <div class="6 col footer-menu">
                <div><a href="../../docs/index.html">docs</a></div>
                <div><a href="../../reference/index.html">reference</a></div>
                <div><a href="../../examples/index.html">examples</a></div>
                <div><a href="../../talk/index.html">talk</a></div>
                <div><a href="../index.html">essays</a></div>
                <div><a href="https://twitter.com/htmx_org">@htmx_org</a></div>
            </div>
        </div>
        <div class="row" style="text-align: center;">
            <div class="col">
                <img src="../../img/bss_bars.png" style="max-width: 30px; margin-top: 3em;">
            </div>
        </div>
    </div>
</footer>

</body>

<!-- Mirrored from htmx.org/essays/splitting-your-apis/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Aug 2023 17:45:24 GMT -->
</html>

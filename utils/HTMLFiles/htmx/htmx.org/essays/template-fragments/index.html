<html lang="en">

<!-- Mirrored from htmx.org/essays/template-fragments/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Aug 2023 17:45:26 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
  <title>&lt;/&gt; htmx ~ Template Fragments</title>
    <link rel="canonical" href="index.html">
    
    <link rel="alternate" type="application/atom+xml" title="Sitewide Atom feed" href="../../atom.xml">
    <link rel="stylesheet" href="../../css/site.css">
    <script src="../../js/htmx.js"></script>
    <script src="../../js/class-tools.js"></script>
    <script src="../../js/preload.js"></script>
    <script src="../../js/_hyperscript.js"></script>
    <meta name="generator" content="Zola v.TODO">
</head>
<body hx-ext="class-tools, preload">

<div class="top-nav">
    <div class="c">
        <div class="menu">
            <div class="logo-wrapper">
                <a href="../../index.html" class="logo light">&lt;<b>/</b>&gt; htm<b>x</b></a>
                <svg _="on click toggle .show on #nav" class="hamburger" viewBox="0 0 100 80" width="25" height="25" style="margin-bottom:-5px">
                    <rect width="100" height="20" style="fill:rgb(52, 101, 164)" rx="10"></rect>
                    <rect y="30" width="100" height="20" style="fill:rgb(52, 101, 164)" rx="10"></rect>
                    <rect y="60" width="100" height="20" style="fill:rgb(52, 101, 164)" rx="10"></rect>
                </svg>
            </div>
            
            <div id="nav" class="navigation" hx-boost="true">
            
                <div class="navigation-items" preload="mouseover">
                    <div><a href="../../docs/index.html">docs</a></div>
                    <div><a href="../../reference/index.html">reference</a></div>
                    <div><a href="../../examples/index.html">examples</a></div>
                    <div><a href="../../talk/index.html">talk</a></div>
                    <div><a href="../index.html">essays</a></div>
                    <div hx-disable>
                        <form action="https://google.com/search">
                            <input type="hidden" name="q" value="site:htmx.org">
                            <label>
                                <span style="display:none;">Search</span>
                                <input type="text" name="q" placeholder="üîçÔ∏è" class="search-box">
                            </label>
                        </form>
                    </div>
                </div>
                <div class="github-stars">
                    <iframe style="margin:auto;" src="https://ghbtns.com/github-btn.html?user=bigskysoftware&amp;repo=htmx&amp;type=star&amp;count=true" frameborder="0" scrolling="0" width="150" height="20" title="Star htmx on GitHub"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>


    


<div class="c content ">
    

  <h1>Template Fragments</h1>
  
    <address>Carson Gross</address>
    <time>August 03, 2022</time>
  

  <p>Template fragments are a relatively rare Server Side Rendering (SSR) template library feature that allow you to render a
<em>fragment</em> or partial bit of the content within a template, rather than the entire template.  This feature is very handy in 
<a href="../hypermedia-driven-applications/index.html">Hypermedia Driven Applications</a> because it allows you to decompose a particular
view for partial updates <em>internally</em> without pulling fragments of the template out to separate files for rendering,
creating a large number of individual template files.</p>
<p>By keeping all the HTML in a single file, it is also easier to reason about how a feature works.  This follows the
<a href="../locality-of-behaviour/index.html">Locality of Behavior</a> design principle.</p>
<h2 id="motivation"><a class="zola-anchor" href="#motivation" aria-label="Anchor link for: motivation">üîó</a>Motivation</h2>
<p>Let‚Äôs look at how template fragments, in an obscure templating language for java called
<a rel="noopener" target="_blank" href="https://github.com/bigskysoftware/chill/tree/master/chill-script">chill templates</a>, can help us build an HDA.</p>
<p>Here is a simple chill template, <code>/contacts/detail.html</code> that displays a contact:</p>
<h5 id="contacts-detail-html"><a class="zola-anchor" href="#contacts-detail-html" aria-label="Anchor link for: contacts-detail-html">üîó</a>/contacts/detail.html</h5>
<pre data-lang="html" style="background-color:#282c34;color:#abb2bf;" class="language-html "><code class="language-html" data-lang="html"><span>&lt;</span><span style="color:#e06c75;">html</span><span>&gt;
</span><span>    &lt;</span><span style="color:#e06c75;">body</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">div </span><span style="color:#d19a66;">hx-target</span><span>=</span><span style="color:#98c379;">&quot;this&quot;</span><span>&gt;
</span><span>          #if contact.archived
</span><span>          &lt;</span><span style="color:#e06c75;">button </span><span style="color:#d19a66;">hx-patch</span><span>=</span><span style="color:#98c379;">&quot;/contacts/${contact.id}/unarchive&quot;</span><span>&gt;Unarchive&lt;/</span><span style="color:#e06c75;">button</span><span>&gt;
</span><span>          #else
</span><span>          &lt;</span><span style="color:#e06c75;">button </span><span style="color:#d19a66;">hx-delete</span><span>=</span><span style="color:#98c379;">&quot;/contacts/${contact.id}&quot;</span><span>&gt;Archive&lt;/</span><span style="color:#e06c75;">button</span><span>&gt;
</span><span>          #end
</span><span>        &lt;/</span><span style="color:#e06c75;">div</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">h3</span><span>&gt;Contact&lt;/</span><span style="color:#e06c75;">h3</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">p</span><span>&gt;${contact.email}&lt;/</span><span style="color:#e06c75;">p</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#e06c75;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#e06c75;">html</span><span>&gt;
</span></code></pre>
<p>In the template we have an archiving feature where, depending on the archive state of the contact, we either display an ‚ÄúArchive‚Äù
or an ‚ÄúUnarchive‚Äù button, both powered by htmx and issuing HTTP requests to different end points.</p>
<p>When we click whichever of the two buttons is being shown, we want to replace the content in the <code>div</code> that surrounds 
the button with an updated button.  (Note the <code>hx-target=&quot;this&quot;</code> on the div, so we are targeting that div‚Äôs innerHTML for
replacement.)  This will effectively flip the back and forth between ‚ÄúArchive‚Äù and ‚ÄúUnarchive‚Äù.</p>
<p>Now, unfortunately, if we wanted to render only the buttons and not the rest of this template, this would typically involve
splitting the buttons out to their own template file and including it in this template, like so:</p>
<h5 id="contacts-detail-html-1"><a class="zola-anchor" href="#contacts-detail-html-1" aria-label="Anchor link for: contacts-detail-html-1">üîó</a>/contacts/detail.html</h5>
<pre data-lang="html" style="background-color:#282c34;color:#abb2bf;" class="language-html "><code class="language-html" data-lang="html"><span>&lt;</span><span style="color:#e06c75;">html</span><span>&gt;
</span><span>    &lt;</span><span style="color:#e06c75;">body</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">div </span><span style="color:#d19a66;">hx-target</span><span>=</span><span style="color:#98c379;">&quot;this&quot;</span><span>&gt;
</span><span>          #include archive-ui.html
</span><span>        &lt;/</span><span style="color:#e06c75;">div</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">h3</span><span>&gt;Contact&lt;/</span><span style="color:#e06c75;">h3</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">p</span><span>&gt;${contact.email}&lt;/</span><span style="color:#e06c75;">p</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#e06c75;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#e06c75;">html</span><span>&gt;
</span></code></pre>
<h5 id="contacts-archive-ui-html"><a class="zola-anchor" href="#contacts-archive-ui-html" aria-label="Anchor link for: contacts-archive-ui-html">üîó</a>/contacts/archive-ui.html</h5>
<pre data-lang="html" style="background-color:#282c34;color:#abb2bf;" class="language-html "><code class="language-html" data-lang="html"><span>#if contact.archived
</span><span>&lt;</span><span style="color:#e06c75;">button </span><span style="color:#d19a66;">hx-patch</span><span>=</span><span style="color:#98c379;">&quot;/contacts/${contact.id}/unarchive&quot;</span><span>&gt;Unarchive&lt;/</span><span style="color:#e06c75;">button</span><span>&gt;
</span><span>#else
</span><span>&lt;</span><span style="color:#e06c75;">button </span><span style="color:#d19a66;">hx-delete</span><span>=</span><span style="color:#98c379;">&quot;/contacts/${contact.id}&quot;</span><span>&gt;Archive&lt;/</span><span style="color:#e06c75;">button</span><span>&gt;
</span><span>#end
</span></code></pre>
<p>Now we have two templates.  We can now render the <code>archive-ui.html</code> template separately, but this split reduces the 
visibility of the archiving feature: it is less obvious what is going on when you are looking just at the <code>detail.html</code> 
template.</p>
<p>When pushed to extremes, decomposing templates like this can lead to quite a few small template fragments which, in
total, become difficult to manage and to reason about.</p>
<h3 id="template-fragments-to-the-rescue"><a class="zola-anchor" href="#template-fragments-to-the-rescue" aria-label="Anchor link for: template-fragments-to-the-rescue">üîó</a>Template Fragments To The Rescue</h3>
<p>To address this issue, chill templates has a <code>#fragment</code> directive.  This directive allows you to specify a block of 
content within a template and render <em>just that bit of content</em>:</p>
<h5 id="contacts-detail-html-using-a-fragment"><a class="zola-anchor" href="#contacts-detail-html-using-a-fragment" aria-label="Anchor link for: contacts-detail-html-using-a-fragment">üîó</a>/contacts/detail.html Using a Fragment</h5>
<pre data-lang="html" style="background-color:#282c34;color:#abb2bf;" class="language-html "><code class="language-html" data-lang="html"><span>&lt;</span><span style="color:#e06c75;">html</span><span>&gt;
</span><span>    &lt;</span><span style="color:#e06c75;">body</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">div </span><span style="color:#d19a66;">hx-target</span><span>=</span><span style="color:#98c379;">&quot;this&quot;</span><span>&gt;
</span><span>          #fragment archive-ui
</span><span>            #if contact.archived
</span><span>            &lt;</span><span style="color:#e06c75;">button </span><span style="color:#d19a66;">hx-patch</span><span>=</span><span style="color:#98c379;">&quot;/contacts/${contact.id}/unarchive&quot;</span><span>&gt;Unarchive&lt;/</span><span style="color:#e06c75;">button</span><span>&gt;
</span><span>            #else
</span><span>            &lt;</span><span style="color:#e06c75;">button </span><span style="color:#d19a66;">hx-delete</span><span>=</span><span style="color:#98c379;">&quot;/contacts/${contact.id}&quot;</span><span>&gt;Archive&lt;/</span><span style="color:#e06c75;">button</span><span>&gt;
</span><span>            #end
</span><span>          #end
</span><span>        &lt;/</span><span style="color:#e06c75;">div</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">h3</span><span>&gt;Contact&lt;/</span><span style="color:#e06c75;">h3</span><span>&gt;
</span><span>        &lt;</span><span style="color:#e06c75;">p</span><span>&gt;${contact.email}&lt;/</span><span style="color:#e06c75;">p</span><span>&gt;
</span><span>    &lt;/</span><span style="color:#e06c75;">body</span><span>&gt;
</span><span>&lt;/</span><span style="color:#e06c75;">html</span><span>&gt;
</span></code></pre>
<p>With this fragment defined in our template, we can now render either the entire template:</p>
<pre data-lang="java" style="background-color:#282c34;color:#abb2bf;" class="language-java "><code class="language-java" data-lang="java"><span>  </span><span style="color:#e5c07b;">Contact</span><span> c = </span><span style="color:#e06c75;">getContact</span><span>();
</span><span>  </span><span style="color:#e5c07b;">ChillTemplates</span><span>.</span><span style="color:#e06c75;">render</span><span>(</span><span style="color:#98c379;">&quot;/contacts/detail.html&quot;</span><span>, </span><span style="color:#98c379;">&quot;contact&quot;</span><span>, c);
</span></code></pre>
<p>Or we can render only the <code>archive-ui</code> <em>fragment</em> of the template</p>
<pre data-lang="java" style="background-color:#282c34;color:#abb2bf;" class="language-java "><code class="language-java" data-lang="java"><span>  </span><span style="color:#e5c07b;">Contact</span><span> c = </span><span style="color:#e06c75;">getContact</span><span>();
</span><span>  </span><span style="color:#e5c07b;">ChillTemplates</span><span>.</span><span style="color:#e06c75;">render</span><span>(</span><span style="color:#98c379;">&quot;/contacts/detail.html#archive-ui&quot;</span><span>, </span><span style="color:#98c379;">&quot;contact&quot;</span><span>, c);
</span></code></pre>
<p>We would use the first option when we want to render the entire detail page for the contact.</p>
<p>We would use the second option when we handled the archive/unarchive actions and wished only to rerender the buttons.</p>
<p>Note that, with fragments, we are able to keep our UI together in a single file and see exactly what is going on with 
the feature, without bouncing around between different template files.  This provides a cleaner and more obvious
implementation of the feature.</p>
<h2 id="known-template-fragment-implementations"><a class="zola-anchor" href="#known-template-fragment-implementations" aria-label="Anchor link for: known-template-fragment-implementations">üîó</a>Known Template Fragment Implementations</h2>
<p>Fragments (and the ability to render them directly in controllers) appear to be a relatively rare feature in templating
libraries and provide an excellent opportunity for improving the developer experience when working with htmx and other
hypermedia-oriented libraries.</p>
<p>Here are some known implementations of the fragment concept:</p>
<ul>
<li>Go
<ul>
<li><a rel="noopener" target="_blank" href="https://pkg.go.dev/text/template">Standard Library (use block actions)</a> <a rel="noopener" target="_blank" href="https://gist.github.com/benpate/f92b77ea9b3a8503541eb4b9eb515d8a">[demo]</a></li>
</ul>
</li>
<li>Java
<ul>
<li><a rel="noopener" target="_blank" href="https://www.thymeleaf.org/doc/tutorials/3.0/usingthymeleaf.html#fragment-specification-syntax">Thymeleaf</a></li>
<li><a rel="noopener" target="_blank" href="https://github.com/bigskysoftware/chill/tree/master/chill-script">Chill Templates (currently in early alpha)</a></li>
<li><a rel="noopener" target="_blank" href="https://quarkus.io/guides/qute-reference#fragments">Quarkus Qute</a></li>
<li><a rel="noopener" target="_blank" href="https://jstach.io/doc/jstachio/current/apidocs/#mustache_fragments">JStachio (mustache)</a></li>
</ul>
</li>
<li>PHP
<ul>
<li><a rel="noopener" target="_blank" href="https://latte.nette.org/en/template-inheritance#toc-blocks">Latte</a> - Use the 3rd parameter to only render 1 block from the template -  <code>$Latte_Engine-&gt;render('path/to/template.latte', [ 'foo' =&gt; 'bar' ], 'content');</code></li>
</ul>
</li>
<li>Python
<ul>
<li><a rel="noopener" target="_blank" href="https://pypi.org/project/django-render-block/">Django Render Block Extension</a> - see <a rel="noopener" target="_blank" href="https://github.com/spookylukey/django-htmx-patterns/blob/master/inline_partials.rst">example code for htmx</a></li>
<li><a rel="noopener" target="_blank" href="https://github.com/sponsfreixes/jinja2-fragments">jinja2-fragments package</a></li>
<li><a rel="noopener" target="_blank" href="https://github.com/mikeckennedy/jinja_partials">jinja_partials package</a> (<a rel="noopener" target="_blank" href="https://github.com/mikeckennedy/jinja_partials/issues/1">discussion</a> on motivation)</li>
<li><a rel="noopener" target="_blank" href="https://github.com/mikeckennedy/chameleon_partials">chameleon_partials package</a></li>
<li><a rel="noopener" target="_blank" href="https://github.com/basxsoftwareassociation/htmlgenerator">htmlgenerator</a></li>
<li><a rel="noopener" target="_blank" href="https://pypi.org/project/django-template-partials/">django-template-partials</a> (<a rel="noopener" target="_blank" href="https://github.com/carltongibson/django-template-partials">repository</a>)</li>
</ul>
</li>
<li>.NET
<ul>
<li><a rel="noopener" target="_blank" href="https://github.com/bit-badger/Giraffe.Htmx/tree/main/src/ViewEngine.Htmx">Giraffe.ViewEngine.Htmx</a></li>
</ul>
</li>
<li>Rust
<ul>
<li><a rel="noopener" target="_blank" href="https://docs.rs/minijinja/latest/minijinja/struct.State.html#method.render_block">MiniJinja</a></li>
</ul>
</li>
</ul>
<p>Please <a href="https://discord.gg/Z6gPqAd">let me know</a> if you know of others, so I can add them to this list.</p>

  <div style="padding-top: 120px;padding-bottom:40px;text-align: center">
    &lt;/&gt;
  </div>
</div>

<footer>
    <div class="c content ">
        <div class="row">
            <div class="6 col footer-haiku">
                <h2>haiku</h2>
                <p><em>
                    javascript fatigue:<br>
                    longing for a hypertext<br>
                    already in hand
                </em></p>
            </div>
            <div class="6 col footer-menu">
                <div><a href="../../docs/index.html">docs</a></div>
                <div><a href="../../reference/index.html">reference</a></div>
                <div><a href="../../examples/index.html">examples</a></div>
                <div><a href="../../talk/index.html">talk</a></div>
                <div><a href="../index.html">essays</a></div>
                <div><a href="https://twitter.com/htmx_org">@htmx_org</a></div>
            </div>
        </div>
        <div class="row" style="text-align: center;">
            <div class="col">
                <img src="../../img/bss_bars.png" style="max-width: 30px; margin-top: 3em;">
            </div>
        </div>
    </div>
</footer>

</body>

<!-- Mirrored from htmx.org/essays/template-fragments/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Aug 2023 17:45:27 GMT -->
</html>
